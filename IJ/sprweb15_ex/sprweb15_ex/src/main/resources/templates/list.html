<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>고객 목록</title>
<style>
.hidden {
	display: none;
}
</style>
<script th:inline="javascript">
function filterTable() {
    const selected = document.querySelector('input[name="gender"]:checked').value;
    let visibleCount = 0;

    for (const row of document.querySelectorAll('tbody tr')) {
        const gender = row.dataset.gender;
        const isVisible = selected === 'all' || 
            (selected === 'male' && gender === '남') || 
            (selected === 'female' && gender === '여');
        
        row.classList.toggle('hidden', !isVisible);
        if(isVisible) visibleCount++;
    }
    
    document.getElementById('totalCount').textContent = `인원수 : ${visibleCount}명`;
}
</script>
</head>
<body>
	<h3>고객 목록</h3>
	<input type="radio" name="gender" id="all" value="all" checked
		onclick="filterTable()">
	<label for="all">전체</label>
	<input type="radio" name="gender" id= "male" value="male" 
	onclick="filterTable()">
		<label for="male">남</label>
	<input type="radio" name="gender" id= "female" value="female"
		onclick="filterTable()">
			<label for="female">여</label>
	<table border="1">
		<thead>
			<tr>
				<th>고객번호</th>
				<th>고객명</th>
				<th>전화</th>
				<th>성별</th>
				<th>나이</th>
			</tr>
		</thead>
		<tbody th:if="${list != null}">
			<tr th:each="list : ${list}"
			th:data-gender="${gender}"
				th:with="gender=${#strings.substring(list.gogekjumin,7,8) == '1' or 
                   #strings.substring(list.gogekjumin,7,8) == '3' ? '남' : '여'}">
				<td th:text="${list.gogekno}"></td>
				<td th:text="${list.gogekname}"></td>
				<td th:text="${list.gogektel}"></td>
				<td th:text="${gender}"></td>
				<td th:text="${list.gogekage}"></td>
			</tr>
		</tbody>
		<tfoot>
			<tr>
				<td colspan="5" id="totalCount"></td>
			</tr>
		</tfoot>
	</table>
	<script th:inline="javascript">
window.onload = filterTable;
</script>
</body>
</html>